  {% extends "base.html" %}
  {% block conteudo %}
  {% with messages = get_flashed_messages() %}
  {% if messages %}
  {% for message in messages %}
  <div class="alert alert-warning alert-dismissible fade show" role="alert">
    <strong> {{ message }}.</strong>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  {% endfor %}
  {% endif %}
  {% endwith %}
    <div class="container-fluid" style="background: #f7f4f3;">
        <div class="row mb-3">
            <div class="col-lg-4">
                <div class="card mb-3">
                    <div class="card-body text-center shadow">
                        <img class="rounded-circle mb-3 mt-4" src="{{ url_for('uploads', filename=user.image ) }}" width="160" height="160">
                        <div class="mb-3">
                          <p>{{user._name}}</p>
                          {% if user._id != session['user_id'] %}
                          {% if not friend_exists %}
                          <a href="{{ url_for('add_friend', id=user._id, name=user._name) }}"><Button
                              class="btn btn-primary btn-sm" type="submit" style="background: rgb(0,0,0);border-radius: 14px;border-style: none;height: 35px;">Seguir</Button></a>
                          {% else %}
                          <a href="{{ url_for('remove_friend', id=friend_exists) }}"><Button class="btn btn-primary btn-sm" type="submit" style="background: rgb(0,0,0);border-radius: 14px;border-style: none;height: 35px;">Remover
                              amigo</Button></a>
                          {% endif %}
                          <a href="{{url_for('chat', id=user._id)}}"><Button class="btn btn-primary btn-sm" type="submit" style="background: rgb(0,0,0);border-radius: 14px;border-style: none;height: 35px;">Mensagem</Button></a>
                          {% endif %}
                        </div>
                    </div>
                </div>
                <div class="card shadow mb-4">
                  <div class="card-header py-3" style="height: 55.5px;">
                    <label class="form-label" for="address" style="color: rgb(0,0,0);font-size: 21px;"><strong>Biografia</strong><br></label></div>
                  <div class="card-body"><textarea style="width: 100%;height: 156px; border: none" disabled>{{user._bibliografy}}</textarea></div>
              </div>
            </div>
            <div class="col-lg-8">
                <div class="row mb-3 d-none">
                    <div class="col">
                        <div class="card textwhite bg-primary text-white shadow">
                            <div class="card-body">
                                <div class="row mb-2">
                                    <div class="col">
                                        <p class="m-0">Peformance</p>
                                        <p class="m-0"><strong>65.2%</strong></p>
                                    </div>
                                    <div class="col-auto"><i class="fas fa-rocket fa-2x"></i></div>
                                </div>
                                <p class="text-white-50 small m-0"><i class="fas fa-arrow-up"></i>&nbsp;5% since last month</p>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card textwhite bg-success text-white shadow">
                            <div class="card-body">
                                <div class="row mb-2">
                                    <div class="col">
                                        <p class="m-0">Peformance</p>
                                        <p class="m-0"><strong>65.2%</strong></p>
                                    </div>
                                    <div class="col-auto"><i class="fas fa-rocket fa-2x"></i></div>
                                </div>
                                <p class="text-white-50 small m-0"><i class="fas fa-arrow-up"></i>&nbsp;5% since last month</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="card shadow mb-3">
                            <div class="card-header py-3"><label class="form-label" for="username" style="color: rgb(0,0,0);font-size: 21px;height: 0.5px;"><strong>Usuário</strong><br></label></div>
                            <div class="card-body">
                                <form>
                                    <div class="row">
                                        <div class="col">
                                            <div class="mb-3"><label class="form-label" for="username"><strong>Username</strong></label><input class="form-control" type="text" id="username" placeholder="{{user._username}}" name="username" disabled></div>
                                        </div>
                                        <div class="col">
                                            <div class="mb-3"><label class="form-label" for="email"><strong>Email Address</strong></label><input class="form-control" type="email" id="email" placeholder="{{user._email}}" name="email" disabled></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="mb-3"><label class="form-label" for="name_complete"><strong>Name Complete</strong></label><input class="form-control" type="text" id="name_complete" placeholder="{{user._name}}" name="name_complete" disabled></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                      <div class="col">
                                        <div class="mb-3"><label class="form-label" for="job"><strong>job</strong></label><input class="form-control" type="text" id="job" placeholder="{{user._job}}" name="job" disabled></div>
                                        <div class="mb-3"><label class="form-label" for="Cidade"><strong>Cidade</strong></label><input class="form-control" type="text" id="Cidade" placeholder="{{user._city}}" name="Cidade" disabled></div>
                                      </div>
                                      <div class="col">
                                        <div class="mb-3"><label class="form-label" for="Data de Nascimento"><strong>Data de Nascimento</strong></label><input class="form-control" type="date" id="Data de Nascimento" value="{{user._age}}" name="Data de Nascimento" disabled></div>
                                        <div class="mb-3"><label class="form-label" for="Estado"><strong>Estado</strong></label><input class="form-control" type="text" id="Estado" placeholder="{{user._state}}" name="Estado" disabled></div>
                                        
                                      </div>
                                  </div>
                                </form>
                                <div class="mb-3">
                                  {% if user._id == session['user_id'] %}
                                  <a href="{{ url_for('user_profile' ,pag='edit', id=session['user_id']) }}"
                                    style="text-decoration: none; color: black;">
                                    <button class="btn btn-primary btn-sm" type="submit" style="background: rgb(0,0,0);border-radius: 14px;border-style: none;height: 35px;">Editar</button>
                                    {% endif %}
                                  </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        #friend-list-btn {
            margin: 1rem;
            width: 11rem;
        }
    
        #container {
            position: relative;
            overflow:auto;
            height: 40rem;
        }
    </style>
    
    <div id="container" class="container-xl shadow p-3 mb-5 bg-body rounded">
        {% if session['login_user'] %}
        <div class="form-publication" hidden>
            <form action="{{url_for('create_post')}}" style="padding: 5vh;" method="POST" enctype="multipart/form-data">
                <h2>Nova pulbicação</h2>
                <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label"> <strong>Titulo</strong> </label>
                    <input type="text" name="title" class="form-control" id="exampleFormControlInput1"
                        placeholder="Titulo">
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="mb-3">
                            <label for="exampleFormControlTextarea1" class="form-label"><strong>Descrição </strong> </label>
                            <textarea class="form-control" id="exampleFormControlTextarea1" name="description"
                                rows="3"></textarea>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="mb-3">
                            <label for="exampleFormControlTextarea1" class="form-label"><strong>Codigo</strong> </label>
                            <textarea class="form-control" id="exampleFormControlTextarea1" name="code" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-8">
                        <div class="mb-3">
                            <label for="formFileMultiple" class="form-label"><strong>Arquivos</strong> </label>
                            <input class="form-control" type="file" name="files[]" id="files" accept="image/*, video/*"
                                multiple="true">
                        </div>
                    </div>
                    <div class="col-4" style=" display: flex; align-items: flex-end;">
                        <div class="mb-3">
                            <button type="submit" class="btn btn-outline-primary" data-bs-toggle="tooltip"
                                data-bs-placement="bottom" title="Publicar"><i class="bi bi-send-plus-fill"></i></button>
                            <button type="button" class="btn btn-outline-danger" data-bs-toggle="tooltip"
                                data-bs-placement="bottom" title="Cancelar" id="btn-close"><i class="bi bi-x-lg"></i></button>
    
                        </div>
                    </div>
                </div>
            </form>
      
        <hr>
    </div>
    
        <div class="modal fade" id="editmodal" tabindex="-1" aria-labelledby="editmodalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editmodalLabel">Atualização do post</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form action="{{url_for('edit_post')}}" method="POST">
                            <input type="hidden" id="idpost" name="idpost">
                            <div class="form-row">
                                <div class="name">Título</div>
                                <div class="value">
                                    <input class="input--style-6" id="title" type="text" name="title" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="name">Descrição</div>
                                <div class="value">
                                    <div class="input-group">
                                        <textarea class="textarea--style-6" id="description" name="description"
                                            placeholder="Coloque a descrção da sua publicação aqui! ;)"></textarea>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Save changes</button>
                        </form>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    
    
        {% endif %}
        <div class="post_list">
            {% if post_list %}
            {% for post in post_list %}
            <div class="post" style="padding: 6vh;">
                <div class="row">
                    <div class="col-sm-1">
                        <img src="{{url_for('uploads', filename=post._user.image)}}" width="75" height="75"
                            class="img-fluid rounded-circle" alt="">
                    </div>
                    <div class="col-sm-11" style="align-self: center;">
                        <div class="row">
                            <div class="col-10 col-sm-6">
                                <h3>{{post._user.name}}</h3>
                            </div>
                            <div class="col-2 col-sm-6" style="display: flex; justify-content: flex-end;">
                                {% if session['user_id'] == post._user.id %}
                                <div class="row" style="align-self: center;">
                                    <div class="col">
                                        <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#editmodal"
                                            data-id="{{ post._idPost}}" data-title="{{post._title}}"
                                            data-desc="{{post._description}}">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                    </div>
                                    <div class="col">
                                        <a href="{{url_for('delete_post', id = post._idPost)}}">
                                            <button class="btn"> <i class="bi bi-trash"></i>
                                            </button>
                                        </a>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div style="padding: 2vh;">
                    <div class="title">
                        <h4 style="color: black;">{{ post._title}}</h4>
                    </div>
                    <div class="post_desc">
                        <a href="{{ url_for('post', id=post._idPost) }}" style="text-decoration: none; color: black;">
                            <p>{{ post._description}} </p>
                        </a>
                    </div>
                </div>
                <div>
                    {% if post._files %}
                    <div id="carouselControls{{post._idPost}}" class="carousel carousel-dark slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
    
                            {% if post._files[0]._type == 'video' %}
                            <div class="carousel-item active">
                                <video controls width="100%">
                                    <source src="{{ url_for('uploads', filename=post.get_first_file()._filename ) }}"
                                        class="rounded mx-auto d-block" width="350" height="350">
                                </video>
                            </div>
                            {% else %}
                            <div class="carousel-item active">
                                <img src="{{ url_for('uploads', filename=post.get_first_file()._filename ) }}"
                                    class="rounded mx-auto d-block" width="350" height="350" alt="...">
                            </div>
                            {% endif %}
    
                            {% for file in post._files %}
    
                            {% if file._type == 'video' %}
                            <div class="carousel-item">
                                <video controls width="100%">
                                    <source src="{{ url_for('uploads', filename=file._filename ) }}"
                                        class="rounded mx-auto d-block" width="350" height="350">
                                </video>
                            </div>
                            {% else %}
                            <div class="carousel-item">
                                <img src="{{ url_for('uploads', filename=file._filename ) }}"
                                    class="rounded mx-auto d-block" width="350" height="350" alt="...">
                            </div>
                            {% endif %}
    
                            {% endfor %}
                        </div>
                        <button class="carousel-control-prev" type="button"
                            data-bs-target="#carouselControls{{post._idPost}}" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button"
                            data-bs-target="#carouselControls{{post._idPost}}" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    {% endif %}
                    <hr>
                </div>
            </div>
            {% endfor %}
            {% else %}
    
            <h4>Não possui nenhuma postagem para visualizar</h4>
            {% endif %}
        </div>
    </div>
    {% endblock %}
